<!DOCTYPE HTML>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Nginx和PHP-FPM配置和优化提示和技巧 - 秦鹏林的个人博客</title>
    	<!-- Facebook and Twitter integration -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!--<link href="http://www.qinpl.cn\api\admin\vendor\static\neat\css\css.css" rel="stylesheet">
	<link href="http://www.qinpl.cn\api\admin\vendor\static\neat\css\css_f.css" rel="stylesheet">-->
	<link href="http://www.qinpl.cn\api\admin\vendor\static\neat\css\my_css.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Oxygen:300,400" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="http://www.qinpl.cn\api\admin\vendor\static\neat\css\animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="http://www.qinpl.cn\api\admin\vendor\static\neat\css\icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="http://www.qinpl.cn\api\admin\vendor\static\neat\css\bootstrap.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="http://www.qinpl.cn\api\admin\vendor\static\neat\css\magnific-popup.css">

	<!-- Flexslider  -->
	<link rel="stylesheet" href="http://www.qinpl.cn\api\admin\vendor\static\neat\css\flexslider.css">

	<!-- Theme style  -->
	<link rel="stylesheet" href="http://www.qinpl.cn\api\admin\vendor\static\neat\css\style.css">

	<!-- Modernizr JS -->
	<script src="http://www.qinpl.cn\api\admin\vendor\static\neat\js\modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->


	</head>
	<style>
		img{width: 100%;}
	</style>
	<body>
		
	<!--<div class="fh5co-loader"></div>-->
	
	<div id="page">
	<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<div style="display: none;" >
				<img src="http://www.qinpl.cn\api\admin\vendor\static\img\logo.png" />
</div>
<nav class="fh5co-nav" role="navigation">
            
		<div class="container-wrap">
			<div class="top-menu">
				<div class="row">
					<div class="col-xs-2">
						<div id="fh5co-logo"><a href="/">Qin</a></div>
					</div>
					
					<div class="col-xs-10 text-right menu-1">
						<ul>
						
							<li ><a href="/">首页</a></li>
				            				            							<li class="  active   has-dropdown "><a href="/Mypl/">我的编程人生</a>
							   <i></i>
							   	<ul class="dropdown">
							   											<li><a href="/Myplphp/">php</a></li>
                                    									<li><a href="/Mypljs/">js</a></li>
                                    									<li><a href="/Mypllinux/">linux</a></li>
                                    									<li><a href="/Myplnginx/">nginx</a></li>
                                    									<li><a href="/Myplmsql/">msql</a></li>
                                    								</ul>
							   							</li>
											            							<li class="   has-dropdown "><a href="/fare/">旅行</a>
							   <i></i>
							   	<ul class="dropdown">
							   											<li><a href="/fare2012/">2012</a></li>
                                    									<li><a href="/fare2017/">2017</a></li>
                                    								</ul>
							   							</li>
											            							<li class="   has-dropdown "><a href="/Download/">下载区</a>
							   <i></i>
							   	<ul class="dropdown">
							   											<li><a href="/Downloadjs/">js下载</a></li>
                                    									<li><a href="/Downloadphp/">php下载</a></li>
                                    									<li><a href="/Downloadxtym/">系统源码下载</a></li>
                                    									<li><a href="/Downloadqtmb/">前台模板下载</a></li>
                                    								</ul>
							   							</li>
													</ul>
					</div>
				</div>
				
			</div>
		</div>
	</nav>	<div class="container-wrap">	
		<div id="fh5co-work">
			<div class="row">
			
				<div class="col-md-8" >
					<span style="border-bottom: 1px solid #CCCCCC;width: 100%;padding-bottom: 10px;" class="fh5co-project-sub qin_list_span">您当前的位置：<a href="/">首页</a>&nbsp;&gt;&nbsp;<a href="/Mypl/">我的编程人生</a>&nbsp;&gt;&nbsp;<a href="/Mypllinux/">linux</a></span>
					<h2 style="margin: 20px 0 10px 0;" class="fh5co-project-title qin_list_h">Nginx和PHP-FPM配置和优化提示和技巧</h2>
					<span style="margin-bottom: 20px;" class="fh5co-project-sub">发布时间：2017-09-27 04 作者：JR</span>
					 <p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">很多情况下，Nginx和PHP-FPM的基本配置都不错，但如果你想从您的VPS或Web服务器/服务器中挤出所有的果汁，并使您的维护工作变得更容易一些，那么本指南可能会有用。这些提示完全取决于我自己的经验，所以它们可能不是一个绝对的事实，在某些情况下，完全不同的配置可能会更好。如果您在同一台机器上运行示例，MySQL，PostgreSQL，MongoDB，邮件服务器，名称服务器和/或SSH服务器，还要记住另一个服务的遗留资源。</span></span></span></span></p>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">是的，我们去...</span></span></span></span></p>

<h2 style="font-style:normal; margin-left:0px; margin-right:0px; text-align:start">Nginx配置和优化提示和技巧</h2>

<h3 style="color:rgba(0, 0, 0, 0.87); font-style:normal; margin-left:0px; margin-right:0px; text-align:start">Nginx提示1. - 组织Nginx配置文件</h3>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">通常，Nginx配置文件位于<em>/ etc / nginx</em>路径下。<br />
组织配置文件的一个好方法是使用Debian / Ubuntu Apache风格设置：</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
<span style="color:#708090">## Main configuration file ##</span>
/etc/nginx/nginx.conf

<span style="color:#708090">## Virtualhost configuration files on ##</span>
/etc/nginx/sites-available/
/etc/nginx/sites-enabled/

<span style="color:#708090">## Other config files on (if needed) ##</span>
/etc/nginx/conf.d/
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">Virtualhost文件有2个路径，因为<strong>站点可用的</strong>目录可以包含任何东西，如测试配置，只是复制/创建的配置，旧的配置等等。而<strong>启用了站点的</strong>仅包含真正启用的配置，实际上<strong>只是</strong>指向站点可用目录的<strong>符号链接</strong>。</span></span></span></span></p>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">请记住在<strong>nginx.conf</strong>文件末尾添加以下内容：</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
<span style="color:#708090">## Load virtual host conf files. ##</span>
include /etc/nginx/sites-enabled/*<span style="color:#f8f8f2">;</span>

<span style="color:#708090">## Load another configs from conf.d/ ##</span>
include /etc/nginx/conf.d/*<span style="color:#f8f8f2">;</span>
</code></span></span></span></span></pre>

<h3 style="color:rgba(0, 0, 0, 0.87); font-style:normal; margin-left:0px; margin-right:0px; text-align:start">Nginx提示2. - 确定Nginx worker_processes和worker_connections</h3>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">对于<em>worker_processes</em>和<em>worker_connections</em>，默认设置是可以的，但是这些值可能会被稍微优化：<br />
<strong>max_clients = worker_processes * worker_connections</strong></span></span></span></span></p>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">只是Nginx的基本设置可以处理数百个并发连接：</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
worker_processes  1<span style="color:#f8f8f2">;</span>
worker_connections  1024<span style="color:#f8f8f2">;</span>
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">通常，1000个并发连接/每个服务器是好的，但有时服务器上的其他部分（如磁盘）可能很慢，导致Nginx在I / O操作上被锁定。为了避免锁定使用示例，请按照以下设置：<strong>一个worker_precess /每个处理器核心</strong>，如：<br />
<strong>Worker Processes</strong></span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
worker_processes <span style="color:#f8f8f2">[</span>number of processor cores<span style="color:#f8f8f2">]</span><span style="color:#f8f8f2">;</span>
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">要检查您有多少处理器内核，请运行以下命令：</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
<span style="color:#e6db74">cat</span> /proc/cpuinfo <span style="color:#f8f8f2">|</span><span style="color:#e6db74">grep</span> processor
processor	<span style="color:#66d9ef">:</span> 0
processor	<span style="color:#66d9ef">:</span> 1
processor	<span style="color:#66d9ef">:</span> 2
processor	<span style="color:#66d9ef">:</span> 3
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">所以这里有4个核心，而worker_processes的最终设置可能在于：</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
worker_processes 4<span style="color:#f8f8f2">;</span>
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><strong>工人连接</strong><br />
个人我坚持1024个工作者连接，因为我没有任何理由提高这个值。但是，如果每秒4096个连接的连接数不足，那么可以尝试将这个连接数增加一倍，并为每个进程设置2048个连接。</span></span></span></span></p>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">worker_processes最终设置可能如下：</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
worker_connections 1024<span style="color:#f8f8f2">;</span>
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">我看到一些配置，其中服务器管理员使用太多的Apache，并认为如果我将Nginx worker_processes设置为50，将worker_connections设置为20000，那么我的服务器可以处理所有流量，一旦我们每月获得...但是，这不是真的。这只是浪费资源，可能会造成一些严重问题</span></span></span></span></p>

<h3 style="color:rgba(0, 0, 0, 0.87); font-style:normal; margin-left:0px; margin-right:0px; text-align:start">Nginx提示3. - 隐藏Nginx服务器令牌/隐藏Nginx版本号</h3>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">这是为了安全起见，隐藏服务器令牌/隐藏Nginx版本号，特别是如果运行一些过时的Nginx版本。这很简单，只需在<strong>http / server / location</strong>部分设置<strong>server_tokens</strong>，如下所示：</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
server_tokens off<span style="color:#f8f8f2">;</span>
</code></span></span></span></span></pre>

<h3 style="color:rgba(0, 0, 0, 0.87); font-style:normal; margin-left:0px; margin-right:0px; text-align:start">Nginx提示4. - Nginx请求/上传最大正文大小（client_max_body_size）</h3>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">如果您想允许用户上传某些内容或通过HTTP上传个人信息，那么您应该可以<strong>增加邮件大小</strong>。可以使用<strong>client_max_body_size</strong>值在<strong>http / server / location</strong>部分下完成。默认值为1 Mb，但可将其设置为20 Mb，并通过以下配置增加缓冲区大小：</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
client_max_body_size 20m<span style="color:#f8f8f2">;</span>
client_body_buffer_size 128k<span style="color:#f8f8f2">;</span>
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">如果您收到以下错误，那么您知道<strong>client_max_body_size</strong>太低：<br />
&ldquo;请求实体太大&rdquo;（413）</span></span></span></span></p>

<h3 style="color:rgba(0, 0, 0, 0.87); font-style:normal; margin-left:0px; margin-right:0px; text-align:start">Nginx提示5. - 静态文件的Nginx缓存控制（浏览器缓存控制指令）</h3>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">如果要保存资源和带宽，则浏览器缓存是导入的。使用Nginx可以很容易地设置，以下是非常基本的设置，其中记录（访问日志和未找到的日志）已关闭，过期标题设置为360天。</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
location ~* \.<span style="color:#f8f8f2">(</span>jpg<span style="color:#f8f8f2">|</span>jpeg<span style="color:#f8f8f2">|</span>gif<span style="color:#f8f8f2">|</span>png<span style="color:#f8f8f2">|</span>css<span style="color:#f8f8f2">|</span>js<span style="color:#f8f8f2">|</span>ico<span style="color:#f8f8f2">|</span>xml<span style="color:#f8f8f2">)</span>$ <span style="color:#f8f8f2">{</span>
    access_log        off<span style="color:#f8f8f2">;</span>
    log_not_found     off<span style="color:#f8f8f2">;</span>
    expires           360d<span style="color:#f8f8f2">;</span>
<span style="color:#f8f8f2">}</span>
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">如果您想要更复杂的标题或其他文件过期，那么您可以单独配置它们。</span></span></span></span></p>

<h3 style="color:rgba(0, 0, 0, 0.87); font-style:normal; margin-left:0px; margin-right:0px; text-align:start">Nginx提示6. - Nginx将PHP请求传递给PHP-FPM</h3>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">这里可以使用默认的tpc / ip栈或直接使用Unix套接字连接。您还必须设置PHP-FPM听完全相同的ip：port或unix套接字（使用Unix套接字，套接字权限必须正确）。默认设置是使用ip：port（127.0.0.1:9000），你当然可以更改ips和ports什么PHP-FPM监听。这是非常基本的配置与Unix套接字注释掉的例子：</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
<span style="color:#708090"># Pass PHP scripts to PHP-FPM</span>
location ~* \.php$ <span style="color:#f8f8f2">{</span>
    fastcgi_index   index.php<span style="color:#f8f8f2">;</span>
    fastcgi_pass    127.0.0.1:9000<span style="color:#f8f8f2">;</span>
    <span style="color:#708090">#fastcgi_pass   unix:/var/run/php-fpm/php-fpm.sock;</span>
    include         fastcgi_params<span style="color:#f8f8f2">;</span>
    fastcgi_param   SCRIPT_FILENAME    <span style="color:#f8f8f2">$document_root</span><span style="color:#f8f8f2">$fastcgi_script_name</span><span style="color:#f8f8f2">;</span>
    fastcgi_param   SCRIPT_NAME        <span style="color:#f8f8f2">$fastcgi_script_name</span><span style="color:#f8f8f2">;</span>
<span style="color:#f8f8f2">}</span>
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">另外还可以运行PHP-FPM另一台服务器和Nginx。</span></span></span></span></p>

<h3 style="color:rgba(0, 0, 0, 0.87); font-style:normal; margin-left:0px; margin-right:0px; text-align:start">Nginx提示7. - 使用Nginx防止（拒绝）访问隐藏的文件</h3>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">通常，服务器根目录或其他公共目录具有隐藏文件，以dot（。）开头，通常不是站点用户。公共目录可以包含版本控制文件和目录，如<em>.svn</em>，某些IDE属性文件和<em>.htaccess</em>文件。拒绝访问并关闭所有隐藏文件的日志记录。</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
location ~ /\. <span style="color:#f8f8f2">{</span>
    access_log off<span style="color:#f8f8f2">;</span>
    log_not_found off<span style="color:#f8f8f2">;</span> 
    deny all<span style="color:#f8f8f2">;</span>
<span style="color:#f8f8f2">}</span>
</code></span></span></span></span></pre>

<h2 style="font-style:normal; margin-left:0px; margin-right:0px; text-align:start">PHP-FPM配置提示和技巧</h2>

<h3 style="color:rgba(0, 0, 0, 0.87); font-style:normal; margin-left:0px; margin-right:0px; text-align:start">PHP-FPM提示1. - PHP-FPM配置文件</h3>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">通常，PHP-FPM配置文件位于<em>/etc/php-fpm.conf</em>文件和<em>/etc/php-fpm.d</em>路径上。这通常是很好的开始，所有的池配置去<em>/etc/php-fpm.d</em>目录。您需要在<em>php-fpm.conf</em>文件中添加以下include行：</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
include<span style="color:#f8f8f2">=</span>/etc/php-fpm.d/*.conf
</code></span></span></span></span></pre>

<h3 style="color:rgba(0, 0, 0, 0.87); font-style:normal; margin-left:0px; margin-right:0px; text-align:start">PHP-FPM提示2. - PHP-FPM全局配置调整</h3>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">设置<em>emergency_restart_threshold</em>，<em>emergency_restart_interval</em>和<em>process_control_timeout</em>。这些选项的默认值完全关闭，但我认为最好使用这些选项，如下所示：</span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
emergency_restart_threshold 10
emergency_restart_interval 1m
process_control_timeout 10s
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><strong>这是什么意思？</strong>因此，如果10分钟PHP-FPM子进程在1分钟内退出SIGSEGV或SIGBUS，那么PHP-FPM将自动重启。此配置还为子进程设置10秒的时间限制，以等待来自主机的信号的响应。</span></span></span></span></p>

<h3 style="color:rgba(0, 0, 0, 0.87); font-style:normal; margin-left:0px; margin-right:0px; text-align:start">PHP-FPM提示3. - PHP-FPM池配置</h3>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">使用PHP-FPM可以为不同的站点使用不同的池，并且非常准确地分配资源，甚至可以为每个池使用不同的用户和组。以下仅是三个不同站点（或实际上同一站点的三个不同部分）的PHP-FPM池的示例配置文件结构：</span></span></span></span></p>

<pre style="text-align:start">
<span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="background-color:#ffffff">/etc/php-fpm.d/site.conf
/etc/php-fpm.d/blog.conf
/etc/php-fpm.d/forums.conf
</span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">每个池的示例配置：<br />
<strong>/etc/php-fpm.d/site.conf</strong></span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
<span style="color:#f8f8f2">[</span>site<span style="color:#f8f8f2">]</span>
listen <span style="color:#f8f8f2">=</span> 127.0.0.1:9000
user <span style="color:#f8f8f2">=</span> site
group <span style="color:#f8f8f2">=</span> site
request_slowlog_timeout <span style="color:#f8f8f2">=</span> 5s
slowlog <span style="color:#f8f8f2">=</span> /var/log/php-fpm/slowlog-site.log
listen.allowed_clients <span style="color:#f8f8f2">=</span> 127.0.0.1
pm <span style="color:#f8f8f2">=</span> dynamic
pm.max_children <span style="color:#f8f8f2">=</span> 5
pm.start_servers <span style="color:#f8f8f2">=</span> 3
pm.min_spare_servers <span style="color:#f8f8f2">=</span> 2
pm.max_spare_servers <span style="color:#f8f8f2">=</span> 4
pm.max_requests <span style="color:#f8f8f2">=</span> 200
listen.backlog <span style="color:#f8f8f2">=</span> -1
pm.status_path <span style="color:#f8f8f2">=</span> /status
request_terminate_timeout <span style="color:#f8f8f2">=</span> 120s
rlimit_files <span style="color:#f8f8f2">=</span> 131072
rlimit_core <span style="color:#f8f8f2">=</span> unlimited
catch_workers_output <span style="color:#f8f8f2">=</span> <span style="color:#e6db74">yes</span>
env<span style="color:#f8f8f2">[</span>HOSTNAME<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> <span style="color:#f8f8f2">$HOSTNAME</span>
env<span style="color:#f8f8f2">[</span>TMP<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> /tmp
env<span style="color:#f8f8f2">[</span>TMPDIR<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> /tmp
env<span style="color:#f8f8f2">[</span>TEMP<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> /tmp
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><strong>/etc/php-fpm.d/blog.conf</strong></span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
<span style="color:#f8f8f2">[</span>blog<span style="color:#f8f8f2">]</span>
listen <span style="color:#f8f8f2">=</span> 127.0.0.1:9001
user <span style="color:#f8f8f2">=</span> blog
group <span style="color:#f8f8f2">=</span> blog
request_slowlog_timeout <span style="color:#f8f8f2">=</span> 5s
slowlog <span style="color:#f8f8f2">=</span> /var/log/php-fpm/slowlog-blog.log
listen.allowed_clients <span style="color:#f8f8f2">=</span> 127.0.0.1
pm <span style="color:#f8f8f2">=</span> dynamic
pm.max_children <span style="color:#f8f8f2">=</span> 4
pm.start_servers <span style="color:#f8f8f2">=</span> 2
pm.min_spare_servers <span style="color:#f8f8f2">=</span> 1
pm.max_spare_servers <span style="color:#f8f8f2">=</span> 3
pm.max_requests <span style="color:#f8f8f2">=</span> 200
listen.backlog <span style="color:#f8f8f2">=</span> -1
pm.status_path <span style="color:#f8f8f2">=</span> /status
request_terminate_timeout <span style="color:#f8f8f2">=</span> 120s
rlimit_files <span style="color:#f8f8f2">=</span> 131072
rlimit_core <span style="color:#f8f8f2">=</span> unlimited
catch_workers_output <span style="color:#f8f8f2">=</span> <span style="color:#e6db74">yes</span>
env<span style="color:#f8f8f2">[</span>HOSTNAME<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> <span style="color:#f8f8f2">$HOSTNAME</span>
env<span style="color:#f8f8f2">[</span>TMP<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> /tmp
env<span style="color:#f8f8f2">[</span>TMPDIR<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> /tmp
env<span style="color:#f8f8f2">[</span>TEMP<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> /tmp
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><strong>/etc/php-fpm.d/forums.conf</strong></span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
<span style="color:#f8f8f2">[</span>forums<span style="color:#f8f8f2">]</span>
listen <span style="color:#f8f8f2">=</span> 127.0.0.1:9002
user <span style="color:#f8f8f2">=</span> forums
group <span style="color:#f8f8f2">=</span> forums
request_slowlog_timeout <span style="color:#f8f8f2">=</span> 5s
slowlog <span style="color:#f8f8f2">=</span> /var/log/php-fpm/slowlog-forums.log
listen.allowed_clients <span style="color:#f8f8f2">=</span> 127.0.0.1
pm <span style="color:#f8f8f2">=</span> dynamic
pm.max_children <span style="color:#f8f8f2">=</span> 10
pm.start_servers <span style="color:#f8f8f2">=</span> 3
pm.min_spare_servers <span style="color:#f8f8f2">=</span> 2
pm.max_spare_servers <span style="color:#f8f8f2">=</span> 4
pm.max_requests <span style="color:#f8f8f2">=</span> 400
listen.backlog <span style="color:#f8f8f2">=</span> -1
pm.status_path <span style="color:#f8f8f2">=</span> /status
request_terminate_timeout <span style="color:#f8f8f2">=</span> 120s
rlimit_files <span style="color:#f8f8f2">=</span> 131072
rlimit_core <span style="color:#f8f8f2">=</span> unlimited
catch_workers_output <span style="color:#f8f8f2">=</span> <span style="color:#e6db74">yes</span>
env<span style="color:#f8f8f2">[</span>HOSTNAME<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> <span style="color:#f8f8f2">$HOSTNAME</span>
env<span style="color:#f8f8f2">[</span>TMP<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> /tmp
env<span style="color:#f8f8f2">[</span>TMPDIR<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> /tmp
env<span style="color:#f8f8f2">[</span>TEMP<span style="color:#f8f8f2">]</span> <span style="color:#f8f8f2">=</span> /tmp
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">所以这只是如何配置多个不同大小的池。</span></span></span></span></p>

<h3 style="color:rgba(0, 0, 0, 0.87); font-style:normal; margin-left:0px; margin-right:0px; text-align:start">PHP-FPM提示4. - PHP-FPM池流程管理器（pm）配置</h3>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">使用PHP-FPM进程管理器的最佳方法是使用动态进程管理，因此只有在需要时才启动PHP-FPM进程。这与Nginx worker_processes和worker_connections设置几乎相同。所以很高的价值观并不意味着什么都好。每个进程都会记忆，当然如果站点拥有非常高的流量和服务器的内存空间，那么更高的值就是正确的选择，但像VPS（虚拟专用服务器）内存这样的服务器通常限制在256 Mb，512 Mb，1024 Mb。这个低RAM足以处理甚至非常高的流量（甚至每秒甚至数十个请求），如果它明智地使用。</span></span></span></span></p>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">测试服务器可以容易处理的PHP-FPM进程有多好，首先启动Nginx和PHP-FPM，并加载一些PHP页面，最好是所有最重的页面。然后使用Linux&nbsp;<em>top或htop命令</em>检查每个PHP-FPM进程示例的内存使用情况。我们假设服务器具有512 Mb内存，220 Mb可用于PHP-FPM，每个进程使用24 Mb RAM（一些庞大的内容管理系统，带插件可以方便地使用20-40 Mb /每PHP页面请求甚至更多） 。然后只需计算服务器max_children值：220/24&nbsp;<br />
= 9.17</span></span></span></span></p>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">这么好的<em>pm.max_children</em>值为9.这只是基于快速平均值，稍后当您看到更长的时间内存使用/每个进程时，这可能是别的。在快速测试之后，设置<strong>pm.start_servers</strong>值，<strong>pm.min_spare_servers</strong>值和<strong>pm.max_spare_servers</strong>值更容易。</span></span></span></span></p>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><strong>最终的示例配置可能如下：</strong></span></span></span></span></p>

<div class="prism-show-language" style="-webkit-text-stroke-width:0px; text-align:start">
<div class="prism-show-language-label" style="border-radius:0px 0px 0px 5px; padding:0px 0.5em; width:auto"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff"><span style="font-size:0.9em"><span style="color:#000000"><span style="background-color:#cfcfcf">巴什</span></span></span></span></span></span></span></div>
</div>

<pre style="margin-left:0px; margin-right:0px; text-align:left">
<span style="font-size:14px"><span style="background-color:#272822"><span style="color:#f8f8f2"><span style="font-family:Consolas,Monaco,&quot;Andale Mono&quot;,&quot;Ubuntu Mono&quot;,monospace"><code>
pm.max_children <span style="color:#f8f8f2">=</span> 9
pm.start_servers <span style="color:#f8f8f2">=</span> 3
pm.min_spare_servers <span style="color:#f8f8f2">=</span> 2
pm.max_spare_servers <span style="color:#f8f8f2">=</span> 4
pm.max_requests <span style="color:#f8f8f2">=</span> 200
</code></span></span></span></span></pre>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">默认情况下，每个进程的最大请求是无限制的，但是设置一些低值（如200）并避免一些内存问题是很好的。这种样式设置可以处理大量的请求，即使数字似乎很小。</span></span></span></span></p>

<h2 style="font-style:normal; margin-left:0px; margin-right:0px; text-align:start">你有问题还是一些不错的Nginx和PHP-FPM提示和技巧？</h2>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">请随时在这里发布您的问题和提示和技巧。</span></span></span></span></p>

<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="font-size:14px"><span style="color:rgba(0, 0, 0, 0.87)"><span style="font-family:Roboto,Helvetica,sans-serif"><span style="background-color:#ffffff">转载于（<a href="https://www.if-not-true-then-false.com/2011/nginx-and-php-fpm-configuration-and-optimizing-tips-and-tricks/">https://www.if-not-true-then-false.com/2011/nginx-and-php-fpm-configuration-and-optimizing-tips-and-tricks/</a>）请翻墙</span></span></span></span></p>

				    </div>
	              <div class="col-md-4 fh5co-project-detail">
	              	<div class="fh5co-project-service">
	              	<h3>评论</h3>
	              						 	
					  <div id="discuss_essay" class="discuss_essay">
   	
   	
   	
   	<script>
			var re=[];
			var a_id=53;
			var html='';
		     
			var h=tree(re,0);
			document.getElementById("discuss_essay").innerHTML =h;
			function tree(arr,pid){	
				var lsz='';
				for(var v in arr){ 
					    if(arr[v]['p_u_id']==pid){
		
		if(arr[v]['p_u_id']==0){
		lsz='</div><div class="discuss_essay_list">'+
		'<a class="discuss_essay_list_img" href="#"><img src="'+arr[v]['u_haerd']+'" /></a>'+
   		'<div class="discuss_essay_list_top"><span>'+arr[v]['name']+'</span>'+arr[v]['info_time']+'<span reply="'+arr[v]['id']+'" class="discuss_essay_list_top_h">回复</span></div>'+
   		'<div class="discuss_essay_list_cent">'+arr[v]['text']+'</div>';
   	    }else{
   	    lsz='</div><div class="discuss_essay_c_list">'+
		'<a class="discuss_essay_list_img" href="#"><img src="'+arr[v]['u_haerd']+'" /></a>'+
   		'<div class="discuss_essay_list_top"><span>'+arr[v]['name']+' 回复 '+arr[v]['p_name']+'</span>'+arr[v]['info_time']+'<span reply="'+arr[v]['id']+'" class="discuss_essay_list_top_h">回复</span></div>'+
   		'<div class="discuss_essay_list_cent">'+arr[v]['text']+'</div>';	
   	    }
					    	html=html+lsz;
					    	tree(arr,arr[v]['id']);					    	
					    }
                         }
				return html;
			}
			
			
		</script> 	
   	<div class="discuss_essay_list">
   		<div class="discuss_essay_c_list">
   	     	<div class="discuss_essay_list_info">
   	     		<textarea id="info"></textarea>
   	     		<span onclick="tj(53,0)">提交</span>
   	     	</div>
   	     </div>
   	</div>
   	
   </div>
	              	
	              	
	              	</div>
					<div class="fh5co-project-service">
						<h3>栏目最新</h3>
						<ul>
							                                <li><a href="http://www.qinpl.cn/Mypllinux/53.html" title="Nginx和PHP-FPM配置和优化提示和技巧" target="_blank">Nginx和PHP-FPM配置和优化提示和技巧</a></li>
                                                            <li><a href="http://www.qinpl.cn/Mypllinux/51.html" title="Linux 定时任务" target="_blank">Linux 定时任务</a></li>
                                                            <li><a href="http://www.qinpl.cn/Mypllinux/46.html" title="Linux Shell脚本编写规范、例子" target="_blank">Linux Shell脚本编写规范、例子</a></li>
                                                            <li><a href="http://www.qinpl.cn/Mypllinux/44.html" title="Linux系统挂载未分配硬盘例子" target="_blank">Linux系统挂载未分配硬盘例子</a></li>
                                                            <li><a href="http://www.qinpl.cn/Mypllinux/35.html" title="Centos 7防火墙firewall开放80端口" target="_blank">Centos 7防火墙firewall开放80端口</a></li>
                                                            <li><a href="http://www.qinpl.cn/Mypllinux/34.html" title="CentOS 7 yum nginx MySQL PHP 简易环境搭建" target="_blank">CentOS 7 yum nginx MySQL PHP 简易环境搭建</a></li>
                              						</ul>
					</div>
				</div>
			</div>
		</div>
	</div><!-- END container-wrap -->

	<div class="container-wrap">
		<footer id="fh5co-footer" role="contentinfo">
			<div class="row">
				<div class="col-md-3 fh5co-widget">
					<h4>About Neat</h4>
					<p>Facilis ipsum reprehenderit nemo molestias. Aut cum mollitia reprehenderit. Eos cumque dicta adipisci architecto culpa amet.</p>
				</div>
				<div class="col-md-3 col-md-push-1">
					<h4>最新更新</h4>
					<ul class="fh5co-footer-links">
						                        <li><a href="http://www.qinpl.cn/Mypllinux/53.html" target="_blank">Nginx和PHP-FPM</a></li>
                                                <li><a href="http://www.qinpl.cn/Myplmsql/52.html" target="_blank">MySQL replace</a></li>
                                                <li><a href="http://www.qinpl.cn/Mypllinux/51.html" target="_blank">Linux 定时任务</a></li>
                                                <li><a href="http://www.qinpl.cn/Myplphp/50.html" target="_blank">UCenter API使用</a></li>
                                                <li><a href="http://www.qinpl.cn/Myplphp/49.html" target="_blank">sphinx的配置文件</a></li>
                        					</ul>
				</div>

				<div class="col-md-3 col-md-push-1">
					<h4>友情链接</h4>
					<ul class="fh5co-footer-links">
						<li><a href="http://www.codejie.net/" target="_blank">源码街</a></li>
					</ul>
				</div>

				<div class="col-md-3">
					<h4>联系方式</h4>
					<ul class="fh5co-footer-links">
						<li>tel:<a href="tel://18883768578">18883768578</a></li>
						<li>e mail:<a href="mailto:1017962047@qq.com">1017962047@qq.com</a></li>
						<li><a href="http://www.qinpl.cn/">www.qinpl.cn</a></li>
					</ul>
				</div>

			</div>

			<div class="row copyright">
				<div class="col-md-12 text-center">
					<p>
						<small class="block"><a href="http://www.qinpl.cn/sitemap.xml" target="_blank">网站地图</a> Design by DanceSmile <a href="http://www.miitbeian.gov.cn" target="_blank">蜀ICP备17013559号-1</a></small>
					</p>
					<p>
						<ul class="fh5co-social-icons">
							<li><a href="#"><i class="icon-twitter"></i></a></li>
							<li><a href="#"><i class="icon-facebook"></i></a></li>
							<li><a href="#"><i class="icon-linkedin"></i></a></li>
							<li>
								<script type="text/javascript">
  		var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
  		document.write(unescape("%3Cspan id='cnzz_stat_icon_1261808781'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1261808781%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
                               </script>                  
							</li>
						</ul>
					</p>
				</div>
			</div>
		</footer>
	</div><!-- END container-wrap -->	
	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up2"></i></a>
	</div>
	
	<!-- jQuery -->
	<script src="http://www.qinpl.cn\api\admin\vendor\static\neat\js\jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="http://www.qinpl.cn\api\admin\vendor\static\neat\js\jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="http://www.qinpl.cn\api\admin\vendor\static\neat\js\bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="http://www.qinpl.cn\api\admin\vendor\static\neat\js\jquery.waypoints.min.js"></script>
	<!-- Flexslider -->
	<script src="http://www.qinpl.cn\api\admin\vendor\static\neat\js\jquery.flexslider-min.js"></script>
	<!-- Magnific Popup -->
	<script src="http://www.qinpl.cn\api\admin\vendor\static\neat\js\jquery.magnific-popup.min.js"></script>
	<script src="http://www.qinpl.cn\api\admin\vendor\static\neat\js\magnific-popup-options.js"></script>
	<!-- Counters -->
	<script src="http://www.qinpl.cn\api\admin\vendor\static\neat\js\jquery.countTo.js"></script>
	<!-- Main -->
	<script src="http://www.qinpl.cn\api\admin\vendor\static\neat\js\main.js"></script>

	<div class="list_zezao">
	<div class="v_k">
      <div class="cols"><span>X</span></div>
      <div id="u_login"></div>
     
      		<a href="http://www.qinpl.cn/admin/Qqlater/Login?qurl=oZKvvyD48/53"></a>

	</div>
</div>
	<script type="text/javascript" src="http://www.qinpl.cn\api\admin\vendor\static/js/config.js" ></script>
	<script type="text/javascript" src="http://www.qinpl.cn\api\admin\vendor\static/js/new.js" ></script>

	</body>
</html>

